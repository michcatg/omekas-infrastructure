;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; CONFIGURACIONES PERSONALIZADAS PARA OMEKA S - DESARROLLO
; Este archivo contiene configuraciones optimizadas para entornos de desarrollo
; Prioriza: Debugging, Detección de Errores y Productividad del Desarrollador
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; SEGURIDAD - RELAJADA PARA DESARROLLO
; Configuraciones menos restrictivas para facilitar debugging
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; expose_php
; En desarrollo podemos dejarlo activado para debugging
; Valor por defecto: On
expose_php = On

; session.cookie_httponly
; Mantenemos la protección XSS incluso en desarrollo
session.cookie_httponly = 1

; session.cookie_secure
; DESACTIVADO: Permite desarrollo en HTTP (localhost, sin certificado SSL)
; IMPORTANTE: Si usas HTTPS local (mkcert), puedes activarlo
session.cookie_secure = 0

; session.use_strict_mode
; Mantener seguridad básica incluso en desarrollo
session.use_strict_mode = 1

; session.use_only_cookies
; Mantener esta restricción
session.use_only_cookies = 1

; session.cookie_samesite
; Lax es suficiente para desarrollo
session.cookie_samesite = Lax

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; LÍMITES DE RECURSOS - GENEROSOS PARA DESARROLLO
; Configuraciones para permitir operaciones pesadas y debugging
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; post_max_size
; Mismo valor que producción para probar uploads grandes
post_max_size = 200M

; upload_max_filesize
; Mismo valor que producción
upload_max_filesize = 200M

; max_execution_time
; Más tiempo para debugging con breakpoints
; Con Xdebug/stepping, los scripts pueden pausarse indefinidamente
max_execution_time = 0

; memory_limit
; Más generoso para debugging (Xdebug consume memoria extra)
; Herramientas de profiling también necesitan más memoria
memory_limit = 1G

; max_input_time
; Sin límite para debugging
max_input_time = -1

; max_input_vars
; Mismo que producción
max_input_vars = 5000

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; MANEJO DE ERRORES - MÁXIMA VISIBILIDAD
; Configuraciones para mostrar TODOS los errores y facilitar debugging
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; error_reporting
; Reportar ABSOLUTAMENTE TODO, incluyendo warnings y notices
; Valor: E_ALL = todos los errores posibles
; Por qué: Detectar incluso el error más pequeño antes de producción
; Incluye: E_DEPRECATED (avisar sobre código obsoleto)
;          E_STRICT (sugerencias de mejores prácticas)
error_reporting = E_ALL

; display_errors
; MOSTRAR errores directamente en la salida HTML
; Por qué: Ver errores inmediatamente sin revisar logs
; CRÍTICO: NUNCA activar en producción
display_errors = On

; display_startup_errors
; Mostrar también errores durante el inicio de PHP
; Útil para detectar problemas de configuración o extensiones
display_startup_errors = On

; log_errors
; TAMBIÉN registrar en log para análisis posterior
; Útil cuando los errores se muestran en AJAX o APIs
log_errors = On

; error_log
; Mismo path que producción para consistencia
error_log = /var/log/php_errors.log

; html_errors
; Formatear errores con HTML para mejor legibilidad en navegador
; Por qué: Enlaces clickeables, sintaxis destacada
html_errors = On

; ignore_repeated_errors
; DESACTIVADO: En desarrollo queremos ver TODOS los errores
; Incluso repetidos pueden indicar problemas en loops
ignore_repeated_errors = Off

; ignore_repeated_source
; DESACTIVADO: Ver cada ocurrencia del error
ignore_repeated_source = Off

; report_memleaks
; Activado para detectar memory leaks durante desarrollo
report_memleaks = On

; track_errors
; Guardar último error en variable $php_errormsg (deprecated en PHP 8)
; Útil para debugging legacy
track_errors = Off

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; ZEND ENGINE - MODO DESARROLLO
; Configuraciones para máxima información de debugging
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; zend.exception_ignore_args
; DESACTIVADO: Queremos ver todos los argumentos en stack traces
; Esencial para debugging de parámetros incorrectos
zend.exception_ignore_args = Off

; zend.exception_string_param_max_len
; Longitud ilimitada de strings en excepciones
; Ver contenido completo de parámetros
zend.exception_string_param_max_len = 0

; zend.assertions
; ACTIVADO: Ejecutar todas las assertions para detectar bugs
; Las assertions son declaraciones de invariantes del código
; assert($user !== null, "User must be logged in");
zend.assertions = 1

; assert.active
; Activar función assert()
assert.active = On

; assert.exception
; Lanzar excepciones en lugar de warnings
; Más fácil de capturar con debugger
assert.exception = On

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; SESIONES - CONFIGURACIÓN BÁSICA
; Mismas configuraciones que producción excepto seguridad relajada
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

session.gc_probability = 1
session.gc_divisor = 100
session.gc_maxlifetime = 86400
session.sid_length = 48
session.sid_bits_per_character = 6
session.save_path = "/var/lib/php/sessions"
session.name = OMEKAS_DEV_SESSION

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; OPCACHE - CONFIGURACIÓN PARA DESARROLLO
; CRÍTICO: Detectar cambios en código automáticamente
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; opcache.enable
; Activado porque incluso en desarrollo mejora rendimiento
; Sin OPcache, cada request es muy lento (útil solo para debugging específico)
opcache.enable = 1

; opcache.enable_cli
; Activado para scripts CLI
opcache.enable_cli = 1

; opcache.memory_consumption
; Menos memoria que producción (suficiente para desarrollo)
opcache.memory_consumption = 128

; opcache.interned_strings_buffer
; Reducido para desarrollo
opcache.interned_strings_buffer = 8

; opcache.max_accelerated_files
; Suficiente para desarrollo
opcache.max_accelerated_files = 10000

; opcache.validate_timestamps
; ACTIVADO: Detectar cambios en archivos automáticamente
; CRÍTICO: Con 0, tendrías que reiniciar PHP después de cada cambio
; Por qué: Editas código, refrescas navegador, ves cambios inmediatamente
opcache.validate_timestamps = 1

; opcache.revalidate_freq
; Verificar cambios cada 2 segundos
; Por qué 2: Balance entre rendimiento y detección de cambios
;            0 = verificar en cada request (muy lento)
;            2 = suficientemente rápido para desarrollo
opcache.revalidate_freq = 2

; opcache.save_comments
; OBLIGATORIO: Omeka S requiere docblocks
opcache.save_comments = 1

; opcache.fast_shutdown
; Mantener optimización
opcache.fast_shutdown = 1

; opcache.max_file_size
; Sin límite
opcache.max_file_size = 0

; opcache.consistency_checks
; ACTIVADO: Detectar corrupciones de caché durante desarrollo
; Útil si modificas archivos mientras PHP los está leyendo
opcache.consistency_checks = 1000

; opcache.force_restart_timeout
; Más corto en desarrollo
opcache.force_restart_timeout = 60

; opcache.huge_code_pages
; Desactivado (optimización innecesaria en desarrollo)
opcache.huge_code_pages = 0

; opcache.file_cache
; Desactivado (no necesario en desarrollo)
; opcache.file_cache = ""

; opcache.file_cache_only
opcache.file_cache_only = 0

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; XDEBUG - CONFIGURACIÓN PARA DEBUGGING
; NOTA: Estas directivas solo aplican si Xdebug está instalado
;       Para instalar: pecl install xdebug
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; xdebug.mode
; Modos: develop (errores mejorados), debug (debugger), coverage, profile
; Múltiples modos separados por comas
; xdebug.mode = debug,develop

; xdebug.start_with_request
; Cuándo activar Xdebug: yes, no, trigger (con parámetro GET/POST/Cookie)
; xdebug.start_with_request = trigger

; xdebug.client_host
; IP donde está el IDE esperando conexiones de Xdebug
; xdebug.client_host = host.docker.internal

; xdebug.client_port
; Puerto del IDE (por defecto 9003 en Xdebug 3)
; xdebug.client_port = 9003

; xdebug.log
; Archivo de log de Xdebug (útil para debugging de Xdebug mismo)
; xdebug.log = /var/log/xdebug.log

; xdebug.max_nesting_level
; Profundidad máxima de llamadas (previene recursión infinita)
; xdebug.max_nesting_level = 512

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; REALPATH CACHE - DESARROLLO
; Caché más pequeño y con TTL corto para detectar cambios de archivos
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; realpath_cache_size
; Suficiente para desarrollo
realpath_cache_size = 4M

; realpath_cache_ttl
; TTL corto para detectar archivos movidos/renombrados
realpath_cache_ttl = 120

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; DATE/TIME - ZONA HORARIA
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

date.timezone = America/Mexico_City

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; INTL - INTERNACIONALIZACIÓN
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

intl.default_locale = es_MX

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; OUTPUT BUFFERING - DESACTIVADO PARA DEBUGGING
; Ver output inmediatamente sin buffering
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; output_buffering
; Por defecto: 4096 (buffer de 4KB)
; Por qué Off: Ver output de var_dump(), echo inmediatamente
; Sin buffering, depuración con print es más efectiva
output_buffering = Off

; implicit_flush
; Enviar output automáticamente sin necesidad de flush()
; Por qué On: Ver progreso de scripts largos en tiempo real
implicit_flush = On

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; DESARROLLO ADICIONAL
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; default_charset
; Charset por defecto para funciones htmlspecialchars, etc.
default_charset = "UTF-8"

; short_open_tag
; Permitir <? en lugar de <?php (no recomendado pero útil en legacy)
short_open_tag = Off

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; FIN DE CONFIGURACIÓN DE DESARROLLO
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;